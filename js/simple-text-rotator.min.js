/* ===========================================================
 * jquery-simple-text-rotator.js v1
 * ===========================================================
 * Copyright 2013 Pete Rojwongsuriya.
 * http://www.thepetedesign.com
 *
 * A very simple and light weight jQuery plugin that 
 * allows you to rotate multiple text without changing 
 * the layout
 * https://github.com/peachananr/simple-text-rotator
 *
 * ========================================================== */
  

!function($){
  var timerId;
  var settings;
  var defaults = {
		animation: "dissolve",
		separator: ",",
		speed: 2000,
		repeat: true,
		text: null,
		onFinish: function () { }
	};
	
	var checkStopped = function () {
        if (rotateStop == true) {
            settings.animation = "";
            clearInterval(timerId);
            //settings.onFinish();
            return false;
        }
	    
	}
	
	function showText() {
	$('#namewrapper').css('display', 'inline-block');
	}
	
	$.fx.step.textShadowBlur = function(fx) {
	checkStopped()
    $(fx.elem).prop('textShadowBlur', fx.now).css({textShadow: '0 0 ' + Math.floor(fx.now) + 'px black'});
  };
	
  $.fn.textrotator = function(options){
    settings = $.extend({}, defaults, options);
    showText();
    checkStopped()
    
    return this.each(function(){
      checkStopped()
      var el = $(this)
      var array = [];
      
      ;

      var text = settings.text || el.text();
	  
        
          $.each(text.split(settings.separator), function(key, value) { 
            array.push(value); 
          });
          el.text(array[0]);
        
      
      var index;
      var checkIndexOverflow = function () {
          index = $.inArray(el.text(), array)
          if ((index + 1) == array.length) {
              index = -1;

              if (settings.repeat == false) {
                  clearInterval(timerId);
                  settings.onFinish();
                  return false;
              }
          }
          return true;
      };
      
       

      // animation option
      var rotate = function() {
        checkStopped()
        switch (settings.animation) { 
          case 'dissolve':
            checkStopped();
            el.animate({
              textShadowBlur:20,
              opacity: 0
            }, 500 , function() {
              checkIndexOverflow();
              el.text(array[index + 1]).animate({
                textShadowBlur:0,
                opacity: 1
              }, 500 );
            });
          break;

          
          case 'fade':
            el.fadeOut(settings.speed, function() {
              checkIndexOverflow();
              el.text(array[index + 1]).fadeIn(settings.speed);
            });
          break;
                
            default:
                break;
        }
      };
      
      timerId = setInterval(rotate, settings.speed);
    });
  }
  
}(window.jQuery);

